/*
 * The MIT License
 *
 * (MIT)Copyright (c) 2015 artjomb
 */
!function(a,b){"function"==typeof define&&define.amd?define(["crypto-js"],b):b(a.CryptoJS)}(this,function(a){var b;b=a.hasOwnProperty("ext")?a.ext:a.ext={},b.bitshift=function(a,b){var c,d,e=0,f=a.words,g=0;if(b>0){for(;b>31;)f.splice(0,1),f.push(0),b-=32,g++;if(0==b)return e;for(var h=f.length-g-1;h>=0;h--)c=f[h],f[h]<<=b,f[h]|=e,e=c>>>32-b}else if(b<0){for(;b<-31;)f.splice(0,0,0),f.length--,b+=32,g++;if(0==b)return e;b=-b,d=(1<<b)-1;for(var h=g;h<f.length;h++)c=f[h]&d,f[h]>>>=b,f[h]|=e,e=c<<32-b}return e},b.neg=function(a){for(var b=a.words,c=0;c<b.length;c++)b[c]=~b[c];return a},b.xor=function(a,b){for(var c=0;c<a.words.length;c++)a.words[c]^=b.words[c];return a},b.bitand=function(a,b){for(var c=a.clone(),d=c.words,e=b.words,f=0;f<d.length;f++)d[f]&=e[f];return c};var b;b=a.hasOwnProperty("ext")?a.ext:a.ext={};var c=a.lib.Base,d=a.lib.WordArray,e=a.algo.AES;b.const_Zero=d.create([0,0,0,0]),b.const_One=d.create([0,0,0,1]),b.const_Rb=d.create([0,0,0,135]),b.const_Rb_Shifted=d.create([2147483648,0,0,67]),b.const_nonMSB=d.create([4294967295,4294967295,2147483647,2147483647]),b.isWordArray=function(a){return a&&"function"==typeof a.clamp&&"function"==typeof a.concat&&"array"==typeof a.words},a.pad.OneZeroPadding={pad:function(a,b){for(var c=4*b,e=c-a.sigBytes%c,f=[],g=0;g<e;g+=4){var h=0;0===g&&(h=2147483648),f.push(h)}var i=d.create(f,e);a.concat(i)},unpad:function(){}},a.pad.NoPadding={pad:function(){},unpad:function(){}},b.leftmostBytes=function(a,b){var c=a.clone();return c.sigBytes=b,c.clamp(),c},b.rightmostBytes=function(a,c){a.clamp();var d=32,e=a.clone(),f=8*(e.sigBytes-c);if(f>=d){var g=Math.floor(f/d);f-=g*d,e.words.splice(0,g),e.sigBytes-=g*d/8}return f>0&&(b.bitshift(e,f),e.sigBytes-=f/8),e},b.popWords=function(a,c){var d=b.leftmostBytes(a,4*c);return a.words=a.words.slice(c),a.sigBytes-=4*c,d},b.shiftBytes=function(a,c){c=c||16;var e=c%4;c-=e;for(var f=d.create(),g=0;g<c;g+=4)f.words.push(a.words.shift()),a.sigBytes-=4,f.sigBytes+=4;return e>0&&(f.words.push(a.words[0]),f.sigBytes+=e,b.bitshift(a,8*e),a.sigBytes-=e),f},b.xorendBytes=function(a,c){return b.leftmostBytes(a,a.sigBytes-c.sigBytes).concat(b.xor(b.rightmostBytes(a,c.sigBytes),c))},b.dbl=function(a){var c=b.msb(a);return b.bitshift(a,1),b.xor(a,1===c?b.const_Rb:b.const_Zero),a},b.inv=function(a){var c=1&a.words[4];return b.bitshift(a,-1),b.xor(a,1===c?b.const_Rb_Shifted:b.const_Zero),a},b.equals=function(a,b){if(!b||!b.words||a.sigBytes!==b.sigBytes)return!1;a.clamp(),b.clamp();for(var c=0,d=0;d<a.words.length;d++)c|=a.words[d]^b.words[d];return 0===c},b.msb=function(a){return a.words[0]>>>31};var c=a.lib.Base,d=a.lib.WordArray,e=a.algo.AES,b=a.ext,f=a.algo.CMAC,g=d.create([0,0,0,0]),h=d.create([0,0,0,1]),i=d.create([0,0,0,2]),j=16;a.EAX=c.extend({init:function(a,c){var d;if(c&&c.splitKey){var e=Math.floor(a.sigBytes/2);d=b.shiftBytes(a,e)}else d=a.clone();this._ctrKey=a,this._mac=f.create(d),this._tagLen=c&&c.tagLength||j,this.reset()},reset:function(){this._mac.update(h),this._ctr&&this._ctr.reset()},updateAAD:function(a){return this._mac.update(a),this},initCrypt:function(c,f){var h=this;return h._tag=h._mac.finalize(),h._isEnc=c,h._mac.update(g),f=h._mac.finalize(f),b.xor(h._tag,f),h._ctr=e.createEncryptor(h._ctrKey,{iv:f,mode:a.mode.CTR,padding:a.pad.NoPadding}),h._buf=d.create(),h._mac.update(i),h},update:function(c){"string"==typeof c&&(c=a.enc.Utf8.parse(c));var e=this,f=e._buf,g=e._isEnc;f.concat(c);var h=g?f.sigBytes:Math.max(f.sigBytes-e._tagLen,0),i=h>0?b.shiftBytes(f,h):d.create(),j=e._ctr.process(i);return e._mac.update(g?j:i),j},finalize:function(a){var c=this,e=a?c.update(a):d.create(),f=c._mac,g=c._ctr.finalize();if(c._isEnc){var h=f.finalize(g);return b.xor(c._tag,h),c.reset(),e.concat(g).concat(c._tag)}var h=f.finalize();return b.xor(c._tag,h),c.reset(),!!b.equals(c._tag,c._buf)&&e.concat(g)},encrypt:function(a,b,c){var d=this;return c&&Array.prototype.forEach.call(c,function(a){d.updateAAD(a)}),d.initCrypt(!0,b),d.finalize(a)},decrypt:function(a,b,c){var d=this;return c&&Array.prototype.forEach.call(c,function(a){d.updateAAD(a)}),d.initCrypt(!1,b),d.finalize(a)}})});