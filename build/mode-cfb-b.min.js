/*
 * The MIT License
 *
 * (MIT)Copyright (c) 2015 artjomb
 */
!function(a,b){"function"==typeof define&&define.amd?define(["crypto-js"],b):b(a.CryptoJS)}(this,function(a){function b(a,b,c){var g,h,i,j=this,k=j._cipher,l=32*k.blockSize,m=j._prevBlock,n=k.cfg.segmentSize,o=[];for(g=31;g<n;g+=32)o.push(4294967295);for(o.push((1<<n)-1<<32-n),g=o.length;g<a.length;g++)o.push(0);o=d.create(o);var p,q=o.clone(),r=q.clone();for(e(r,32*-b),g=0;g<l/n;g++){if(m){for(m=d.create(m),e(m,n),m=m.words,previousCiphertextSegment=j._ct;previousCiphertextSegment.length<l/32;)previousCiphertextSegment.push(0);previousCiphertextSegment=d.create(previousCiphertextSegment),e(previousCiphertextSegment,-l+n);for(var h=0;h<m.length;h++)m[h]|=previousCiphertextSegment.words[h]}else m=j._iv.slice(0),j._iv=void 0;i=32*b+g*n;var s=d.create(a.slice(0));e(s,i),c||(j._ct=s.words.slice(0,Math.ceil(n/32)));var t=m.slice(0);for(k.encryptBlock(t,0),h=0;h<Math.ceil(n/32);h++)s.words[h]^=t[h];for(h=0;h<s.words.length;h++)s.words[h]&=o.words[h];for(c&&(j._ct=s.words.slice(0,Math.ceil(n/32))),p=f(r.clone()),h=0;h<a.length;h++)a[h]&=p.words[h];for(e(s,-i),h=0;h<a.length;h++)a[h]|=s.words[h];e(q,-n),e(r,-n)}j._prevBlock=m}var c=a.lib.BlockCipherMode.extend(),d=a.lib.WordArray,e=a.ext.bitshift,f=a.ext.neg;c.Encryptor=c.extend({processBlock:function(a,c){b.call(this,a,c,!0)}}),c.Decryptor=c.extend({processBlock:function(a,c){b.call(this,a,c,!1)}}),a.mode.CFBb=c});